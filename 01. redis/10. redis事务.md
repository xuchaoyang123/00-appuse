>## 十、redis事务
#

### 1.事务基本概念 
```bash
   概念:
    #ACID一致性: 一个事务里的sql要么同时成功,要么同时失败.
    #redis单条命令是保证原子性的,但是事务不保证原子性的.
    #redis没有隔离级别的概念.
    #所有的命令在事务中,并没有直接被执行,只有发起执行命令的时候才会执行.--队列 set set set 执行----
    #运行时异常 如果事务里有三个set,其中一个set有错误,那么其他两个会成功,错误的会失败,进行提交事务.
    #编译型异常(代码有问题,命令有错)事务中的所有事务都会回滚.
    #这两种异常理解;好比买一个车一看就是坏的那肯定不能买,买回来以后开了一段时间发现有坏的地方,那没办法退了. 

  redis事务:
    #开启事务(multi)
    #命令入队(普通命令:set...)
    #执行事务(exec)

  redis乐观锁:
    #redis可以实现乐观锁,watch监视器.  

```

```bash
    #提交事务
    127.0.0.1:6379> multi                               #开启事务.
    127.0.0.1:6379> set key01 value01                   #现在命令会进入队列,不会直接执行.
    127.0.0.1:6379> exec                                #顺序真正的执行命令  

    #回滚事务
    127.0.0.1:6379> multi                               #开启事务.
    127.0.0.1:6379> set key01 value01                   #现在命令会进入队列,不会直接执行.
    127.0.0.1:6379> discard                             #取消事务.  

    #编译型异常(代码有问题,命令有错)事务中的所有事务都会回滚.
    127.0.0.1:6379> multi                               #开启事务.
    127.0.0.1:6379> set key01 value01                   #现在命令会进入队列,不会直接执行.
    127.0.0.1:6379> abc key01                           #没有这个命令,直接爆出异常. 
    127.0.0.1:6379> exec                                #执行完后,整体都会回滚.

    #运行时异常 如果事务里有三个set,其中一个set有错误,那么其他两个会成功,错误的会失败,进行提交事务.
    127.0.0.1:6379> multi                               #开启事务.
    127.0.0.1:6379> set key01 value01                   #现在命令会进入队列,不会直接执行.
    127.0.0.1:6379> incr key01 1                        #只有数字可以自增,字符串不能,但是这里执行会放入队列不跑异常,只有执行的时候回报错.
    127.0.0.1:6379> set key02 value02                   #现在命令会进入队列,不会直接执行.
    127.0.0.1:6379> exec                                #执行完后,incr报错,其他事务都执行完毕提交.


```

